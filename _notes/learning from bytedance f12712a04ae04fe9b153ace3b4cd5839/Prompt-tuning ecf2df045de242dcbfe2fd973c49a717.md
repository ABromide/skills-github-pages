# Prompt-tuning

https://wjn1996.blog.csdn.net/article/details/120607050

https://blog.csdn.net/qq_24729325/article/details/132673944

æˆªæ­¢23å¹´3æœˆåº•ï¼Œè¯­è¨€æ¨¡å‹èµ°è¿‡äº†ä¸‰ä¸ªé˜¶æ®µï¼š

- **ç¬¬ä¸€é˜¶æ®µ** ï¼šè®¾è®¡ä¸€ç³»åˆ—çš„è‡ªç›‘ç£è®­ç»ƒç›®æ ‡ï¼ˆMLMã€NSPç­‰ï¼‰ï¼Œè®¾è®¡æ–°é¢–çš„æ¨¡å‹æ¶æ„ï¼ˆTransformerï¼‰ï¼Œéµå¾ªPre-trainingå’ŒFine-tuningèŒƒå¼ã€‚å…¸å‹ä»£è¡¨æ˜¯BERTã€GPTã€XLNetç­‰ï¼›
- **ç¬¬äºŒé˜¶æ®µ** ï¼šé€æ­¥æ‰©å¤§æ¨¡å‹å‚æ•°å’Œè®­ç»ƒè¯­æ–™è§„æ¨¡ï¼Œæ¢ç´¢ä¸åŒç±»å‹çš„æ¶æ„ã€‚å…¸å‹ä»£è¡¨æ˜¯BARTã€T5ã€GPT-3ç­‰ï¼›
- **ç¬¬ä¸‰é˜¶æ®µ** ï¼šèµ°å‘AIGCï¼ˆArtificial Intelligent Generated Contentï¼‰æ—¶ä»£ï¼Œæ¨¡å‹å‚æ•°è§„æ¨¡æ­¥å…¥åƒä¸‡äº¿ï¼Œæ¨¡å‹æ¶æ„ä¸ºè‡ªå›å½’æ¶æ„ï¼Œå¤§æ¨¡å‹èµ°å‘å¯¹è¯å¼ã€ç”Ÿæˆå¼ã€å¤šæ¨¡æ€æ—¶ä»£ï¼Œæ›´åŠ æ³¨é‡ä¸äººç±»äº¤äº’è¿›è¡Œå¯¹é½ï¼Œå®ç°å¯é ã€å®‰å…¨ã€æ— æ¯’çš„æ¨¡å‹ã€‚å…¸å‹ä»£è¡¨æ˜¯InstructionGPTã€ChatGPTã€Bardã€GPT-4ç­‰ã€‚

Prompt-Tuningçš„åŠ¨æœºæ—¨åœ¨è§£å†³ç›®å‰ä¼ ç»ŸFine-tuningçš„ä¸¤ä¸ªç—›ç‚¹é—®é¢˜ï¼š

- **é™ä½è¯­ä¹‰å·®å¼‚ï¼ˆBridge the gap between Pre-training and Fine-tuningï¼‰** ï¼šé¢„è®­ç»ƒä»»åŠ¡ä¸»è¦ä»¥Masked Language Modelingï¼ˆMLMï¼‰ä¸ºä¸»ï¼Œè€Œä¸‹æ¸¸ä»»åŠ¡åˆ™é‡æ–°å¼•å…¥æ–°çš„è®­ç»ƒå‚æ•°ï¼Œå› æ­¤ä¸¤ä¸ªé˜¶æ®µçš„ç›®æ ‡é€šå¸¸æœ‰è¾ƒå¤§å·®å¼‚ã€‚å› æ­¤éœ€è¦è§£å†³å¦‚ä½•ç¼©å°Pre-trainingå’ŒFine-tuningä¸¤ä¸ªé˜¶æ®µç›®æ ‡å·®è·è¿‡å¤§çš„é—®é¢˜ï¼›
- **é¿å…è¿‡æ‹Ÿåˆï¼ˆOverfitting of the headï¼‰** ï¼šç”±äºåœ¨Fine-tuningé˜¶æ®µéœ€è¦æ–°å¼•å…¥é¢å¤–çš„å‚æ•°ä»¥é€‚é…ç›¸åº”çš„ä»»åŠ¡éœ€è¦ï¼Œå› æ­¤åœ¨æ ·æœ¬æ•°é‡æœ‰é™çš„æƒ…å†µå®¹æ˜“å‘ç”Ÿè¿‡æ‹Ÿåˆï¼Œé™ä½äº†æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚å› æ­¤éœ€è¦é¢å¯¹é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹çš„è¿‡æ‹Ÿåˆé—®é¢˜ã€‚

åšä¸»æ ¹æ®å¯¹Prompt-Tuningä¸¤å¹´å¤šçš„ç ”ç©¶ç»éªŒï¼Œæ€»ç»“äº†ä¸‰ä¸ªå…³äºPromptçš„æœ¬è´¨ï¼Œå¦‚ä¸‹ï¼š

- Promptçš„æœ¬è´¨æ˜¯ä¸€ç§å¯¹ä»»åŠ¡çš„æŒ‡ä»¤ï¼›
- Promptçš„æœ¬è´¨æ˜¯ä¸€ç§å¯¹é¢„è®­ç»ƒä»»åŠ¡çš„å¤ç”¨ï¼›
- Promptçš„æœ¬è´¨æ˜¯ä¸€ç§å‚æ•°æœ‰æ•ˆæ€§å­¦ä¹ ï¼›

ç”±äºç»å¤§å¤šæ•°çš„è¯­è¨€æ¨¡å‹éƒ½é‡‡ç”¨MLMæˆ–ALMè¿›è¡Œè®­ç»ƒï¼Œæ‰€ä»¥æˆ‘ä»¬ç°å¦‚ä»Šæ‰€çœ‹åˆ°çš„å¤§å¤šæ•°åŸºäºPromptçš„åˆ†ç±»éƒ½è¦è®¾è®¡Templateå’ŒVerbalizerã€‚é‚£ä¹ˆæˆ‘ä»¬æ˜¯å¦å¯ä»¥æå¤§åŒ–åœ°åˆ©ç”¨MLMå’ŒALMçš„å…ˆéªŒçŸ¥è¯†åœ¨ä¸åŒçš„ä¸‹æ¸¸ä»»åŠ¡ä¸Šè·å¾—æ›´å¥½çš„è¡¨ç°ï¼Ÿæ˜¯å¦å¯ä»¥è®¾è®¡ä¸€ä¸ªå…¨æ–°çš„é¢„è®­ç»ƒä»»åŠ¡æ¥æ»¡è¶³ä¸€äº›ä¸‹æ¸¸ä»»åŠ¡çš„éœ€æ±‚å‘¢ï¼Ÿ

æˆ‘ä»¬ä»‹ç»ä¸¤ä¸ªå……åˆ†åˆ©ç”¨è¿™ä¸ªæ€æƒ³çš„æ–¹æ³•ï¼š

- **ä¸‡ç‰©çš†å¯ç”Ÿæˆ** ï¼šå°†æ‰€æœ‰ä»»åŠ¡ç»Ÿä¸€ä¸ºæ–‡æœ¬ç”Ÿæˆï¼Œæå¤§åŒ–åˆ©ç”¨å•å‘è¯­è¨€æ¨¡å‹ç›®æ ‡ï¼›
- **ä¸‡ç‰©çš†å¯æŠ½å–** ï¼šå°†æ‰€æœ‰ä»»åŠ¡ç»Ÿä¸€ä¸ºæŠ½å–å¼é˜…è¯»ç†è§£ï¼Œå¹¶è®¾è®¡æŠ½å–å¼é¢„è®­ç»ƒç›®æ ‡ï¼›
- **ä¸‡ç‰©çš†å¯æ¨ç†** ï¼šå°†æ‰€æœ‰ä»»åŠ¡å»ºæ¨¡ä¸ºè‡ªç„¶è¯­è¨€æ¨æ–­ï¼ˆNatural Language Inferenceï¼‰æˆ–ç›¸ä¼¼åº¦åŒ¹é…ä»»åŠ¡ã€‚

### Promptçš„æœ¬è´¨æ˜¯å‚æ•°æœ‰æ•ˆæ€§å­¦ä¹ 

æ ¹æ®å‰æ–‡çš„è®²è§£ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå®ç°Prompt-Tuningåªéœ€è¦è€ƒè™‘å¦‚ä½•è®¾è®¡æ¨¡æ¿æˆ–æŒ‡ä»¤ï¼Œè€Œæ¨¡å‹å’Œè®­ç»ƒç›®æ ‡åˆ™éƒ½æ˜¯å¤ç”¨é¢„è®­ç»ƒé˜¶æ®µçš„ï¼Œå³åœ¨æ•´ä¸ªè®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæ— é¡»æ·»åŠ ä»»ä½•å‚æ•°ï¼ˆæˆ–åªéœ€è¦æ·»åŠ éå¸¸å°‘é‡çš„ä¸æ¨¡æ¿æœ‰å…³çš„å‚æ•°ï¼‰ï¼Œè€Œå…¶ä»–å‚æ•°éƒ½æ˜¯è®­ç»ƒå¥½çš„ã€‚åŸºäºè¿™ä¸ªæ€æƒ³ï¼Œæˆ‘ä»¬å†ä¸€æ¬¡å°†Promptå‡ååˆ°æ›´é«˜çš„å±‚é¢â€”â€” **Promptçš„æœ¬è´¨æ˜¯å‚æ•°æœ‰æ•ˆæ€§å­¦ä¹ ï¼ˆParameter-Efficient Learningï¼ŒPELï¼‰** ã€‚

> å‚æ•°æœ‰æ•ˆæ€§å­¦ä¹ çš„èƒŒæ™¯
> 
> 
> **å‚æ•°æœ‰æ•ˆæ€§è®­ç»ƒ**
> 

å¸¸è§ç»å…¸çš„å‚æ•°æœ‰æ•ˆæ€§å­¦ä¹ æœ‰Adapter-Tuningã€Prefix-Tuningã€BitFitã€‚ä¸‹é¢è¿›è¡Œç®€å•çš„ä»‹ç»ã€‚

Adapter-Tuningåœ¨2019å¹´æå‡ºï¼Œå…¶é¢å‘é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹çš„å‚æ•°æœ‰æ•ˆæ€§å­¦ä¹ ã€‚åœ¨å¤šå±‚Transformeræ¨¡å‹ä¸­ï¼Œåœ¨å¾®è°ƒè¿‡ç¨‹ä¸­æ‰€æœ‰çš„å‚æ•°éƒ½éœ€è¦æ›´æ–°ï¼Œæ˜¾ç„¶å¹¶ä¸æ˜¯æœ‰æ•ˆçš„ã€‚ä¸ºäº†æé«˜æ•ˆç‡ï¼Œè¯¥æ–¹æ³•æå‡ºå›ºå®šTransformerçš„å…¨éƒ¨å‚æ•°ï¼Œç„¶ååœ¨Transformerçš„æ¯ä¸€ä¸ªBlocké‡ŒåµŒå…¥ä¸€äº›æ–°åˆå§‹åŒ–çš„Adapter Networkã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

Adapterä½äºFeed-Forward Layerä¹‹åã€æ®‹å·®è¿æ¥ä¹‹å‰ã€‚Adapteræœ¬è´¨ä¸Šå°±æ˜¯ä¸¤å±‚MLPï¼Œåˆ†åˆ«è´Ÿè´£å°†Transformerçš„è¡¨å¾é™ç»´å’Œå‡ç»´ï¼ˆå³å›¾ï¼‰ã€‚åŸºäºAdapterçš„æ–¹æ³•ï¼Œ **åªéœ€è¦æ·»åŠ ä¸åˆ°5%çš„å¯è®­ç»ƒå‚æ•°ï¼Œå³å¯ä»¥å‡ ä¹è¾¾åˆ°å…¨å‚æ•°è®­ç»ƒçš„æ•ˆæœ** ï¼Œåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å¤§å¤§èŠ‚çœäº†è®­ç»ƒæ—¶é—´ï¼Œåšåˆ°æ—¶é—´æœ‰æ•ˆæ€§ã€‚å› æ­¤åœ¨çœŸå®åœºæ™¯åº”ç”¨æ—¶ï¼Œ **ä¸åŒçš„ä»»åŠ¡æˆ‘ä»¬ä¸éœ€è¦é‡æ–°å¯¹æ•´ä¸ªé¢„è®­ç»ƒæ¨¡å‹è¿›è¡Œå¾®è°ƒï¼Œæˆ‘ä»¬åªéœ€è¦ä¿å­˜Adapterå³å¯** ï¼Œè€Œé¢„è®­ç»ƒæ¨¡å‹çš„å…¶ä»–å‚æ•°éƒ½æ˜¯åŸå§‹é¢„è®­ç»ƒçš„ï¼Œè¿™æ ·å°±åšåˆ°äº†ç©ºé—´çš„æœ‰æ•ˆæ€§ã€‚

![æˆªå±2024-09-03 11.28.16.png](Prompt-tuning%20ecf2df045de242dcbfe2fd973c49a717/%25E6%2588%25AA%25E5%25B1%258F2024-09-03_11.28.16.png)

[**P-tuning**](https://hf.co/papers/2103.10385)Â adds trainable prompt embeddings to the input that is optimized by a prompt encoder to find a better prompt, eliminating the need to manually design prompts. The prompt tokens can be added anywhere in the input sequence, and p-tuning also introduces anchor tokens for improving performance.(æ·»åŠ äº†å¯è®­ç»ƒçš„prompt embeddingsï¼Œè¿™æ ·å°±ä¸ç”¨æ‰‹åŠ¨è°ƒæ•´prompts)

## é¢å‘è¶…å¤§è§„æ¨¡æ¨¡å‹çš„Prompt-Tuning

æœ¬æ–‡é»˜è®¤ä»¥GPT-3ä¸ºä¾‹ï¼Œä»‹ç»å‡ ä¸ªé¢å‘è¶…å¤§è§„æ¨¡çš„Prompt-Tuningæ–¹æ³•ï¼Œåˆ†åˆ«ä¸ºï¼š

- **ä¸Šä¸‹æ–‡å­¦ä¹  In-Context Learningï¼ˆICLï¼‰** ï¼šç›´æ¥æŒ‘é€‰å°‘é‡çš„è®­ç»ƒæ ·æœ¬ä½œä¸ºè¯¥ä»»åŠ¡çš„æç¤ºï¼›
- **æŒ‡ä»¤å­¦ä¹  Instruction-tuning** ï¼šæ„å»ºä»»åŠ¡æŒ‡ä»¤é›†ï¼Œä¿ƒä½¿æ¨¡å‹æ ¹æ®ä»»åŠ¡æŒ‡ä»¤åšå‡ºåé¦ˆï¼›
- **æ€ç»´é“¾ Chain-of-Thoughtï¼ˆCoTï¼‰** ï¼šç»™äºˆæˆ–æ¿€å‘æ¨¡å‹å…·æœ‰æ¨ç†å’Œè§£é‡Šçš„ä¿¡æ¯ï¼Œé€šè¿‡çº¿æ€§é“¾å¼çš„æ¨¡å¼æŒ‡å¯¼æ¨¡å‹ç”Ÿæˆåˆç†çš„ç»“æœã€‚

### InstructionGPT

å¦å¤–ä¸€ä¸ªå…¸å‹çš„ä¾‹å­æ˜¯OpenAIçš„InstructionGPTï¼Œå…¶ä¸»è¦æµç¨‹å¦‚ä¸‹ï¼š

[https://bytedance.larkoffice.com/space/api/box/stream/download/asynccode/?code=NmQ2NDIyMzhlMDY0YjM3OWE1NGViY2NjMDRhMWRmZmJfMnI1ZHhrNUI5Qks1dzN1WHh1dVRrTW9MeERtcm55b0lfVG9rZW46VjJWZWIzWmJrbzRGdXN4U1B6dGMwdzl3bkVlXzE3MjE4MjQ0Mjc6MTcyMTgyODAyN19WNA](https://bytedance.larkoffice.com/space/api/box/stream/download/asynccode/?code=NmQ2NDIyMzhlMDY0YjM3OWE1NGViY2NjMDRhMWRmZmJfMnI1ZHhrNUI5Qks1dzN1WHh1dVRrTW9MeERtcm55b0lfVG9rZW46VjJWZWIzWmJrbzRGdXN4U1B6dGMwdzl3bkVlXzE3MjE4MjQ0Mjc6MTcyMTgyODAyN19WNA)

- **Step1** ï¼šå…ˆé‡‡æ ·ä¸€äº›demonstrationæ•°æ®ï¼Œå…¶åŒ…æ‹¬promptå’Œlabeled answerã€‚åŸºäºè¿™äº›æ ‡æ³¨çš„æ•°æ®ï¼Œå¯¹GPT-3è¿›è¡Œfine-tuningï¼Œå¾—åˆ°SFTï¼ˆSupervised Fine-tuningï¼‰ï¼›

> é›‡ä½£40åæ ‡æ³¨äººå‘˜å®Œæˆpromptçš„æ ‡æ³¨ã€‚
æ­¤æ—¶çš„SFTæ¨¡å‹åœ¨éµå¾ªæŒ‡ä»¤/å¯¹è¯æ–¹é¢å·²ç»ä¼˜äº GPT-3ï¼Œä½†ä¸ä¸€å®šç¬¦åˆäººç±»åå¥½ã€‚
> 
- **Step2** ï¼šFine-tuningå®Œä¹‹åï¼Œå†ç»™ä¸€ä¸ªpromptè®©SFTæ¨¡å‹ç”Ÿæˆå‡ºè‹¥å¹²ç»“æœï¼ˆå¯ä»¥é€šè¿‡beam searchç­‰æ–¹æ³•ï¼‰ï¼Œä¾‹å¦‚ç”ŸæˆABCDå››ç§ç»“æœï¼Œé€šè¿‡äººå·¥ä¸ºå…¶æ’åºï¼Œä¾‹å¦‚D>C>A=Bï¼Œå¯ä»¥å¾—åˆ°æ ‡æ³¨çš„æ’åºpairï¼›åŸºäºæ ‡æ³¨çš„æ’åºç»“æœï¼Œè®­ç»ƒä¸€ä¸ªReward Modelï¼›

> å¯¹å¤šä¸ªæ’åºç»“æœï¼Œä¸¤ä¸¤ç»„åˆï¼Œå½¢æˆå¤šä¸ªè®­ç»ƒæ•°æ®å¯¹ã€‚RMæ¨¡å‹æ¥å—ä¸€ä¸ªè¾“å…¥ï¼Œç»™å‡ºè¯„ä»·å›ç­”è´¨é‡çš„åˆ†æ•°ã€‚è¿™æ ·ï¼Œå¯¹äºä¸€å¯¹è®­ç»ƒæ•°æ®ï¼Œè°ƒèŠ‚å‚æ•°ä½¿å¾—é«˜è´¨é‡å›ç­”çš„æ‰“åˆ†æ¯”ä½è´¨é‡çš„æ‰“åˆ†è¦é«˜ã€‚
> 
- **Step3** ï¼šç»§ç»­ç”¨ç”Ÿæˆå‡ºæ¥çš„ç»“æœè®­ç»ƒSFTï¼Œå¹¶é€šè¿‡å¼ºåŒ–å­¦ä¹ çš„PPOæ–¹æ³•ï¼Œæœ€å¤§åŒ–SFTç”Ÿæˆå‡ºæ’åºé å‰çš„answerã€‚

> è®­ç»ƒç›®æ ‡å¦‚ä¸‹ï¼š
åˆå§‹åŒ–æ—¶
PPOç®—æ³•åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ç¯å¢ƒä¼šå‘ç”Ÿå˜æ¢ã€‚
é¦–å…ˆï¼Œæ ¹æ®è‡ªåŠ¨æ ‡æ³¨çš„æ•°æ®ï¼ˆä¸‹é¢çš„æ¥æº3ï¼‰ï¼Œå–‚å…¥ ä¸­ï¼Œå¾—åˆ°è¾“å‡ºç»“æœ ï¼Œå…¶ä¼šæ ¹æ® å¾—åˆ°ä¸€ä¸ªå¾—åˆ†ï¼ŒæœŸæœ›åœ¨è®­ç»ƒ æ—¶èƒ½å¤Ÿæœ€å¤§åŒ–rewardçš„å¾—åˆ†ï¼›
ç¬¬äºŒé¡¹lossè¡¨ç¤ºKLæ•£åº¦ï¼Œåœ¨è¿­ä»£è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œé¿å…RLæ¨¡å‹ ä¸åŸå§‹çš„ç›‘ç£è®­ç»ƒçš„SFTæ¨¡å‹å·®çš„å¤ªè¿œï¼›
ç¬¬ä¸‰é¡¹åˆ™æ˜¯ä¸€ä¸ªé¢„è®­ç»ƒç›®æ ‡ï¼Œå¯ä»¥ç†è§£ä¸ºé¿å…ç¾éš¾é—å¿˜ã€‚å½“ æ—¶åˆ™ä¸ºæ ‡å‡†çš„PPOæ¨¡å‹ï¼Œå¦åˆ™ä¸ºPPO-ptxæ¨¡å‹1.3B å‚æ•° InstructGPT æ¨¡å‹çš„è¾“å‡ºä¼˜äº 175B GPT-3 çš„è¾“å‡ºï¼Œå°½ç®¡å‚æ•°å°‘äº† 100 å¤šå€ã€‚
> 

# Promptè‡ªåŠ¨ä¼˜åŒ–

https://zhuanlan.zhihu.com/p/658649353

https://zhuanlan.zhihu.com/p/673323386

https://mp.weixin.qq.com/s/53jEDw58dkZlJAVzr31G8A

P-tuningï¼š

<aside>
ğŸ’¡

æ€»ç»“æ¥è¯´ï¼šv1å°±æ˜¯è¿ç»­ç‰ˆæœ¬çš„prompt tuningæ–¹æ³•ï¼Œå¯¹äºå‚æ•°é‡å°äº10äº¿çš„æ¨¡å‹æ¥è¯´ï¼Œä½¿ç”¨è¿ç»­çš„embeddingè°ƒä¼˜æ–¹å¼è¿›è¡Œä¼˜åŒ–ã€‚ä½†æ˜¯ç¼ºç‚¹æ˜¯ä¸Šä¸‹æ–‡é•¿åº¦é™åˆ¶äº†è°ƒä¼˜çš„å‚æ•°

v2åˆ™åŠ å¤šäº†å±‚çº§å’Œå‰ç¼€çš„ä¼˜åŒ–ï¼Œä¸å†æ˜¯å¯¹äºä¸­é—´çš„promptå¯¹åº”çš„è¯è¿›è¡Œæ“ä½œï¼Œè€Œæ˜¯æ·»åŠ äº†ä¸€ä¸ªå›ºå®šçš„å‰ç¼€ã€‚åœ¨æ¯ä¸€å±‚æ·»åŠ å¯¹åº”çš„å¯è®­ç»ƒçš„å‚æ•°

</aside>

https://mp.weixin.qq.com/s/tZOl4JPXKXXdaxvXPYSKtQ

https://wandb.ai/sauravmaheshkar/softprompts/reports/Brief-Introduction-to-P-Tuning--Vmlldzo3MTgyODIz

![image.png](Prompt-tuning%20ecf2df045de242dcbfe2fd973c49a717/image.png)

![image.png](Prompt-tuning%20ecf2df045de242dcbfe2fd973c49a717/image%201.png)